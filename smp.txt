import zipfile
import os
import magic

# Paths
docx_file_path = "/path/to/your/document.docx"
output_folder = "/path/to/output/folder"

# Create the output directory if it doesn't exist
os.makedirs(output_folder, exist_ok=True)

# Function to identify file type
def identify_file_type(file_path):
    mime = magic.Magic(mime=True)
    return mime.from_file(file_path)

# Open the .docx file as a zip archive
with zipfile.ZipFile(docx_file_path, 'r') as docx_zip:
    for file_info in docx_zip.infolist():
        # Look for embedded objects in the 'word/embeddings' folder
        if file_info.filename.startswith('word/embeddings/'):
            extracted_path = os.path.join(output_folder, file_info.filename.split('/')[-1])
            # Extract the embedded file
            with open(extracted_path, 'wb') as output_file:
                output_file.write(docx_zip.read(file_info))
            print(f"Extracted: {extracted_path}")
            
            # Identify the file type
            file_type = identify_file_type(extracted_path)
            print(f"File type of {extracted_path}: {file_type}")

            # Optionally rename the file based on its type
            if "pdf" in file_type:
                os.rename(extracted_path, extracted_path.replace(".bin", ".pdf"))
            elif "email" in file_type:
                os.rename(extracted_path, extracted_path.replace(".bin", ".msg"))
            # Add more conditions here for other file types if needed
